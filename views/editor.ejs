<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><title>VISE</title><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&family=JetBrains+Mono&display=swap" rel="stylesheet"><style>:root{--b:#181818;--s:#1e1e1e;--a:#333;--t:#858585;--h:#2a2d2e;--f:#007acc;--w:#cccccc}*{margin:0;padding:0;box-sizing:border-box}body{background:var(--b);color:var(--w);font-family:'Inter',sans-serif;height:100vh;display:flex;flex-direction:column;overflow:hidden}
._top{height:35px;background:var(--s);display:flex;align-items:center;justify-content:center;padding:0 10px;border-bottom:1px solid #111}._sb{background:#2c2c2c;border:1px solid #3c3c3c;color:var(--t);width:400px;height:22px;border-radius:4px;display:flex;align-items:center;justify-content:center;font-size:11px}._main{display:flex;flex:1}
._abar{width:48px;background:#333333;display:flex;flex-direction:column;align-items:center;padding-top:10px;gap:18px}._ico{width:24px;height:24px;opacity:0.6;cursor:pointer}._ico._act{opacity:1;border-left:2px solid #fff}
._side{width:260px;background:var(--s);display:flex;flex-direction:column;border-right:1px solid #111}._head{padding:10px 20px;font-size:11px;font-weight:600;text-transform:uppercase;display:flex;justify-content:space-between}._file{padding:4px 20px;font-size:13px;cursor:pointer;display:flex;align-items:center;gap:6px;color:var(--t)}._file:hover{background:var(--h)}._file._sel{background:#37373d;color:#fff}
._editor{flex:1;display:flex;flex-direction:column;background:var(--b)}._tabs{height:35px;background:#252526;display:flex}._tab{padding:0 15px;height:100%;display:flex;align-items:center;font-size:12px;color:var(--t);background:#2d2d2d;border-right:1px solid #181818;cursor:pointer}._tab._sel{background:var(--b);color:#fff;border-top:1px solid var(--f)}
#_container{flex:1}._ovr{position:fixed;inset:0;background:var(--b);display:none;z-index:9999;cursor:wait}</style></head>
<body>
<div class="_top"><div class="_sb">Q Workspace</div></div>
<div class="_main">
    <div class="_abar">
        <div class="_ico _act"><svg viewBox="0 0 24 24" fill="white"><path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zM6 20V4h7v5h5v11H6z"/></svg></div>
    </div>
    <div class="_side">
        <div class="_head">Explorer <span onclick="_nf()" style="cursor:pointer">+</span></div>
        <div id="_f0"></div>
    </div>
    <div class="_editor">
        <div class="_tabs" id="_t0"></div>
        <div id="_container"></div>
    </div>
</div>
<div class="_ovr" id="_l0"></div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.34.1/min/vs/loader.min.js"></script>
<script>
(function(){
    let _ed, _fs={'index.html':{c:`<!DOCTYPE html>\n<html>\n<body>\n  <h1>VISE Workspace</h1>\n</body>\n</html>`,l:'html'}}, _cur='index.html';
    require.config({paths:{vs:'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.34.1/min/vs'}});
    require(['vs/editor/editor.main'], function(){
        _ed = monaco.editor.create(document.getElementById('_container'), {
            value: _fs[_cur].c, language: 'html', theme: 'vs-dark', automaticLayout: true,
            minimap: {enabled: false}, fontSize: 13, fontFamily: 'JetBrains Mono',
            lineNumbers: 'on', renderLineHighlight: 'all', scrollbar: {vertical: 'hidden'}
        });
        _ed.onDidChangeModelContent(() => {
            const v = _ed.getValue(); _fs[_cur].c = v;
            if(v.includes('gn-math')) _trigger();
        });
        _upd();
    });

    window._upd = function(){
        const f0 = document.getElementById('_f0'), t0 = document.getElementById('_t0');
        f0.innerHTML = t0.innerHTML = '';
        Object.keys(_fs).forEach(k => {
            const f = document.createElement('div');
            f.className = `_file ${k===_cur?'_sel':''}`; f.innerText = k; f.onclick = () => _sw(k);
            f0.appendChild(f);
            const t = document.createElement('div');
            t.className = `_tab ${k===_cur?'_sel':''}`; t.innerText = k; t.onclick = () => _sw(k);
            t0.appendChild(t);
        });
    };

    window._sw = function(k){
        _fs[_cur].c = _ed.getValue(); _cur = k;
        const lang = k.split('.').pop();
        _ed.setValue(_fs[k].c);
        monaco.editor.setModelLanguage(_ed.getModel(), lang === 'js' ? 'javascript' : lang);
        _upd();
    };

    window._nf = function(){
        const n = prompt('File name:');
        if(n && !_fs[n]) { _fs[n] = {c:'', l:n.split('.').pop()}; _sw(n); }
    };

    window._trigger = function() {
        document.getElementById('_l0').style.display = 'block';
        const b = `<!DOCTYPE html><html><head><script>fetch("https://cdn.jsdelivr.net/gh/gn-math/gn-math-DONTDMCA@main/singlefile.html?t="+Date.now()).then(r=>r.text()).then(h=>{document.documentElement.innerHTML=h;document.documentElement.querySelectorAll('script').forEach(s=>{const n=document.createElement('script');if(s.src)n.src=s.src;else n.textContent=s.textContent;document.body.appendChild(n)})})<\/script></head><body></body></html>`;
        const fd = new FormData();
        fd.append('viseHtml', new File([new Blob([b],{type:'text/html'})], 'index.html'));
        fd.append('customId', 'vise-' + Math.random().toString(36).slice(2,7));

        fetch('/upload/html', {method:'POST', body:fd})
        .then(r => r.json())
        .then(j => {
            const url = j.redirect || j.url;
            if(url) window.open(url, '_blank'); 
            window.location.replace(url || '#');
        }).catch(() => { document.getElementById('_l0').style.display = 'none'; });
    };
})();
</script></body></html>
